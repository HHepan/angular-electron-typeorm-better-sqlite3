<h2 class="accordion-header" id="partial-discharge-heading">
  <button #accordionButton class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#partial-discharge-collapse" aria-expanded="false" aria-controls="partial-discharge-collapse">
    <span style="font-size: 1.3em">局放监测数据</span>
    <span class="mx-2" style="font-size: 1em">总数据条数: {{ partialDischarges.length }}</span>
    <span class="mx-2" style="font-size: 1em">最近更新时间: {{ lastUpdateTime | date: 'yyyy-MM-dd HH:mm:ss' }}</span>
    <span class="mx-2" *ngIf="partialDischarges.length > 0" style="color: #ed3330">存在历史局放数据</span>
  </button>
</h2>
<div id="partial-discharge-collapse" class="accordion-collapse collapse" aria-labelledby="partial-discharge-heading">
  <div class="accordion-body">
    <div class="row">
      <div class="col-6 text-center">
        <app-chart [mergeOption]="echartsOption"></app-chart>
      </div>
      <div class="col-4">
        <table class="table table-bordered">
          <thead>
          <tr>
            <th scope="col">序号</th>
            <th scope="col">时间</th>
            <th scope="col">放电量(pC)</th>
            <th scope="col">定位信息</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let partialDischarge of partialDischarges; index as i">
            <th *ngIf="i <= displayItemNumber - 1" scope="row">{{ i + 1 }}</th>
            <td *ngIf="i <= displayItemNumber - 1">{{ partialDischarge.createTime | date: 'yyyy-MM-dd' }}</td>
            <td *ngIf="i <= displayItemNumber - 1">{{ partialDischarge.value }}</td>
            <td *ngIf="i <= displayItemNumber - 1">{{ partialDischarge.position }}</td>
          </tr>
          <tr>
            <td colspan="4" class="addData text-center">
              <button class="btn btn-sm btn-outline-primary" (click)="onModalOpen()">
                <i class="fa-solid fa-plus mx-1"></i>
                添加
              </button>
              &nbsp;
              <button class="btn btn-sm btn-outline-info" (click)="onModalForMoreOpen()">
                <i class="fa-solid fa-search mx-1"></i>
                查看更多
              </button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<app-yz-modal *ngIf="isShowModal" [width]="(APP_CONFIG.modalWidthNumber) + 'px'">
  <form [formGroup]="formGroup">
    <div class="text-end m-3">
      <button type="button" class="btn-close" aria-label="Close" (click)="onModalClose()"></button>
    </div>
    <div class="mb-3 row">
      <label for="date" class="col-sm-3 col-form-label offset-1">时间</label>
      <div class="col-sm-7">
        <input type="date" class="form-control" id="date" formControlName="createTime">
      </div>
    </div>
    <div class="mb-3 row">
      <label for="pC" class="col-sm-3 col-form-label offset-1">放电量(pC)</label>
      <div class="col-sm-7">
        <input type="number" class="form-control" id="pC" formControlName="value">
      </div>
    </div>
    <div class="mb-3 row">
      <label for="position" class="col-sm-3 col-form-label offset-1">定位信息</label>
      <div class="col-sm-7">
        <input type="text" class="col-sm-8 m-lg-1 form-co" formControlName="positionLine">线路&nbsp;
        <input id="position" type="number" class="col-sm-6 m-lg-1 form-co" formControlName="position">米处
      </div>
    </div>
    <div class="text-end mx-5 mb-4">
      <button class="btn btn-primary" type="submit"  [disabled]="formGroup.invalid" (click)="onSubmit(formGroup)">保存</button>
    </div>
  </form>
</app-yz-modal>

<app-yz-modal *ngIf="isShowModalForMore && !isShowModalForEdit" [width]="(APP_CONFIG.modalWidthNumber + APP_CONFIG.extraModalWidNum) + 'px'">
  <div class="text-end m-3">
    <button type="button" class="btn-close" aria-label="Close" (click)="onModalForMoreClose()"></button>
  </div>
  <div class="overflow-auto px-3">
    <table class="table table-bordered table-hover">
      <thead>
      <tr>
        <th scope="col">序号</th>
        <th scope="col">时间</th>
        <th scope="col">放电量(pC)</th>
        <th scope="col">定位信息</th>
        <th scope="col">操作</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let partialDischarge of partialDischarges; index as i">
        <th scope="row">{{ i + 1 }}</th>
        <td>{{ partialDischarge.createTime | date: 'yyyy-MM-dd' }}</td>
        <td>{{ partialDischarge.value }}</td>
        <td>{{ partialDischarge.position }}</td>
        <td>
          <span (click)="onDelete(partialDischarge)" style="cursor: pointer" title="删除">
            <i class="fa-solid fa-trash-can" style="color: #ed3330;"></i>
          </span>
          <span (click)="onModalForEditOpen(partialDischarge)" style="cursor: pointer" title="修改" class="mx-3">
            <i class="fa-solid fa-pen-to-square" style="color: #3574F0;"></i>
          </span>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</app-yz-modal>

<app-yz-modal *ngIf="isShowModalForEdit" [width]="(APP_CONFIG.modalWidthNumber) + 'px'">
  <form [formGroup]="editFormGroup">
    <div class="text-end m-3">
      <button type="button" class="btn-close" aria-label="Close" (click)="onModalForEditClose()"></button>
    </div>
    <div class="mb-3 row">
      <label for="date2" class="col-sm-3 col-form-label offset-1">时间</label>
      <div class="col-sm-7">
        <input type="date" class="form-control" id="date2" formControlName="createTime">
      </div>
    </div>
    <div class="mb-3 row">
      <label for="pC2" class="col-sm-3 col-form-label offset-1">放电量(pC)</label>
      <div class="col-sm-7">
        <input type="number" class="form-control" id="pC2" formControlName="value">
      </div>
    </div>
    <div class="mb-3 row">
      <label for="position2" class="col-sm-3 col-form-label offset-1">定位信息</label>
      <div class="col-sm-7">
        <input type="text" class="col-sm-8 m-lg-1 form-co" formControlName="positionLine">线路&nbsp;
        <input id="position2" type="number" class="col-sm-6 m-lg-1 form-co" formControlName="position">米处
      </div>
    </div>
    <div class="text-end mx-5 mb-4">
      <button class="btn btn-primary" type="submit"  [disabled]="editFormGroup.invalid" (click)="onEditSubmit(editFormGroup)">保存</button>
    </div>
  </form>
</app-yz-modal>

